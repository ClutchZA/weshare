<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WeShare — Premium Slots</title>
<link rel="icon" href="/public/weshare-logo.png" />
<style>
  :root{--bg:#0b0e13;--card:#12161d;--card2:#0f1319;--fg:#e8edf5;--muted:#9aa6b2;--brand:#ef4444;--accent:#6366f1;--border:#222a36;--ring:rgba(99,102,241,.35)}
  *{box-sizing:border-box}html,body{height:100%}body{margin:0;background:#0b0e13;color:var(--fg);font:16px/1.5 system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial}
  .hero{background:linear-gradient(180deg,#111827 0%,#0d1117 100%);padding:28px 20px 36px;border-bottom:1px solid #10151d}
  .hero-inner{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:16px}
  .logo{height:44px;width:44px;border-radius:12px;background:#1a1f2a;overflow:hidden;display:grid;place-items:center}
  .logo img{height:100%;width:100%;object-fit:cover;display:block}
  .hgroup{display:flex;flex-direction:column}.hgroup h1{margin:0;font-size:28px}.hgroup p{margin:2px 0 0;color:var(--muted)}
  .wrap{max-width:1100px;margin:0 auto;padding:28px}.grid{display:grid;gap:22px}
  @media(min-width:980px){.grid{grid-template-columns:1.1fr .9fr}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:22px;box-shadow:0 16px 50px rgba(0,0,0,.35)}
  h2{margin:0 0 8px;font-size:22px}.lead{color:var(--muted);margin:6px 0 14px}
  .plans{display:grid;gap:10px;margin-top:14px}.plan{display:flex;justify-content:space-between;align-items:center;gap:10px;background:var(--card2);border:1px solid var(--border);border-radius:14px;padding:12px 14px;cursor:pointer}
  .plan input{appearance:none;height:18px;width:18px;border:2px solid #556175;border-radius:50%}.plan input:checked{background:var(--brand);border-color:var(--brand)}
  .plan .meta{display:flex;gap:10px;align-items:center}
  .form{display:grid;gap:14px;margin-top:14px}.row2{display:grid;gap:14px}@media(min-width:640px){.row2{grid-template-columns:1fr 1fr}}
  label{display:block;font-size:14px;color:#c9d3df;margin-bottom:6px}
  .control{width:100%;height:46px;padding:0 12px;background:#0b1016;color:var(--fg);border:1px solid #222a36;border-radius:12px;font-size:15px;outline:none;transition:border-color .2s,box-shadow .2s}
  .control:focus{border-color:var(--ring);box-shadow:0 0 0 6px var(--ring)}
  .check{display:flex;align-items:center;gap:10px;color:#c9d3df}.check input{height:18px;width:18px;accent-color:var(--accent)}
  .line{display:flex;justify-content:space-between;margin:8px 0;color:#cfd6df}.divider{height:1px;background:var(--border);margin:12px 0}
  .total{display:flex;justify-content:space-between;align-items:center;font-weight:800;font-size:18px}
  .btn{width:100%;height:48px;border:none;border-radius:12px;background:linear-gradient(135deg,var(--brand),#f87171);color:white;font-weight:800;box-shadow:0 16px 40px rgba(239,68,68,.35);cursor:pointer;letter-spacing:.2px}
  footer{color:#93a0b0;text-align:center;padding:26px}
  a.small{color:#9aa6b2}
</style>
</head>
<body>
  <section class="hero">
    <div class="hero-inner">
      <div class="logo"><img src="/public/weshare-logo.png" alt="WeShare logo"></div>
      <div class="hgroup">
        <h1>WeShare</h1>
        <p>Card payments • Instant setup • South Africa</p>
      </div>
    </div>
  </section>

  <div class="wrap">
    <div class="grid">
      <section class="card">
        <h2>YouTube <span style="color:#ef4444">R49</span> · Spotify <span style="color:#10b981">R39</span> · Bundle <span style="color:#6366f1">R79</span></h2>
        <p class="lead">Ad‑free YouTube + background play, and Spotify Premium music — set up in minutes.</p>

        <div class="plans">
          <label class="plan">
            <div class="meta">
              <input type="radio" name="plan" value="youtube" checked>
              <div><div>YouTube Premium — Family Slot</div><div style="color:#9aa6b2">Best for video lovers</div></div>
            </div><div><b>R49</b>/mo</div>
          </label>
          <label class="plan">
            <div class="meta">
              <input type="radio" name="plan" value="spotify">
              <div><div>Spotify Premium — Family Slot</div><div style="color:#9aa6b2">Unlimited music</div></div>
            </div><div><b>R39</b>/mo</div>
          </label>
          <label class="plan">
            <div class="meta">
              <input type="radio" name="plan" value="bundle">
              <div><div>Bundle — YouTube + Spotify</div><div style="color:#9aa6b2">1 of each</div></div>
            </div><div><b>R79</b>/mo</div>
          </label>
        </div>

        <div class="form">
          <div class="row2">
            <div><label for="qty">Quantity</label><input id="qty" class="control" type="number" min="1" max="6" value="1"></div>
            <div><label for="cycle">Billing</label>
              <select id="cycle" class="control">
                <option value="monthly">Monthly</option>
                <option value="quarterly">Quarterly (save 5%)</option>
                <option value="yearly">Yearly (save 12%)</option>
              </select>
            </div>
          </div>
          <div class="row2">
            <div><label for="email">Email</label><input id="email" class="control" type="email" placeholder="you@example.com"></div>
            <div><label for="wa">WhatsApp</label><input id="wa" class="control" type="tel" placeholder="+27 82 123 4567"></div>
          </div>
          <div class="check"><input id="agree" type="checkbox"><label for="agree" style="margin:0">I agree to the Terms.</label></div>
        </div>
      </section>

      <aside class="card">
        <h3 style="margin:0 0 8px">Order Summary</h3>
        <div class="line"><span>Plan</span><span id="sPlan">YouTube</span></div>
        <div class="line"><span>Price / slot</span><span id="sPrice">R49</span></div>
        <div class="line"><span>Quantity</span><span id="sQty">1</span></div>
        <div class="line"><span>Billing</span><span id="sCycle">Monthly</span></div>
        <div class="divider"></div>
        <div class="line"><span>Total due today</span><span id="sTotal">R49.00</span></div>
        <button id="payBtn" class="btn" disabled>Pay by Card</button>
        <p><a class="small" href="/api/hello" target="_blank">API ping</a></p>
      </aside>
    </div>
  </div>

  <footer>© 2025 WeShare — Card processing by PayFast.</footer>

<script>
(function(){
  const prices={youtube:49,spotify:39,bundle:79};
  const mult={monthly:1,quarterly:3*0.95,yearly:12*0.88};
  const planRad=[...document.querySelectorAll('input[name=\"plan\"]')];
  const qty=document.getElementById('qty'),cycle=document.getElementById('cycle'),email=document.getElementById('email'),wa=document.getElementById('wa'),agree=document.getElementById('agree'),payBtn=document.getElementById('payBtn');
  const sPlan=document.getElementById('sPlan'),sPrice=document.getElementById('sPrice'),sQty=document.getElementById('sQty'),sCycle=document.getElementById('sCycle'),sTotal=document.getElementById('sTotal');
  const fmt=n=>'R'+n.toFixed(2);
  function currentPlan(){return planRad.find(r=>r.checked)?.value||'youtube'}
  function update(){
    const p=currentPlan(),price=prices[p],q=Math.max(1,Math.min(6,parseInt(qty.value||'1',10)));qty.value=q;
    const cyc=cycle.value,m=mult[cyc],total=price*q*m;
    sPlan.textContent=p==='youtube'?'YouTube':(p==='spotify'?'Spotify':'Bundle');
    sPrice.textContent='R'+price;sQty.textContent=q;sCycle.textContent=cyc[0].toUpperCase()+cyc.slice(1);sTotal.textContent=fmt(total);
    const valid=agree.checked&&email.value.includes('@')&&(wa.value||'').trim().length>=8;
    payBtn.disabled=!valid;
  }
  planRad.forEach(r=>r.addEventListener('change',update));
  [qty,cycle,email,wa,agree].forEach(e=>e.addEventListener('input',update));update();

  payBtn.addEventListener('click', async ()=>{
    const payload={
      plan: currentPlan(),
      quantity: Number(qty.value),
      billingCycle: cycle.value,
      email: email.value,
      whatsapp: wa.value
    };
    try{
      const res=await fetch('/api/payfast/create-checkout', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload)});
      const data=await res.json();
      if(!data.url) throw new Error('No URL returned');
      if(data.mock){ alert('Mock checkout URL (add PayFast keys to make it live):\n'+data.url); }
      else { window.location.href=data.url; }
    }catch(err){ alert('Checkout error: '+(err.message||err)); }
  });
})();
</script>
</body>
</html>
