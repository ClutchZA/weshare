<!doctype html>
<html lang="en"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>WeShare — Premium Slots</title>
<link rel="icon" href="/public/weshare-logo.png">
<body style="font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;margin:0;color:#e8edf5;background:#0b0e13">
<div style="padding:22px;background:#111827;border-bottom:1px solid #0f1623;display:flex;align-items:center;gap:12px">
  <img src="/public/weshare-logo.png" width="40" height="40" style="border-radius:10px">
  <div><div style="font-weight:800;font-size:20px">WeShare</div><div style="color:#9aa6b2">Card payments • South Africa</div></div>
</div>
<div style="max-width:960px;margin:0 auto;padding:22px;display:grid;gap:16px">
  <div style="background:#12161d;border:1px solid #222a36;border-radius:14px;padding:18px">
    <h2 style="margin:0 0 8px">YouTube R49 • Spotify R39 • Bundle R79</h2>
    <div>Ad‑free YouTube, background play, and Spotify Premium — set up in minutes.</div>
    <div style="margin-top:12px;display:grid;gap:10px">
      <label><input type="radio" name="plan" value="youtube" checked> YouTube</label>
      <label><input type="radio" name="plan" value="spotify"> Spotify</label>
      <label><input type="radio" name="plan" value="bundle"> Bundle</label>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px">
      <input id="qty" type="number" min="1" max="6" value="1" placeholder="Qty" style="padding:10px;border-radius:10px;border:1px solid #222a36;background:#0b1016;color:#e8edf5">
      <select id="cycle" style="padding:10px;border-radius:10px;border:1px solid #222a36;background:#0b1016;color:#e8edf5">
        <option value="monthly">Monthly</option>
        <option value="quarterly">Quarterly (save 5%)</option>
        <option value="yearly">Yearly (save 12%)</option>
      </select>
      <input id="email" placeholder="you@example.com" style="grid-column:1/3;padding:10px;border-radius:10px;border:1px solid #222a36;background:#0b1016;color:#e8edf5">
      <input id="wa" placeholder="+27 82 123 4567" style="grid-column:1/3;padding:10px;border-radius:10px;border:1px solid #222a36;background:#0b1016;color:#e8edf5">
      <label style="grid-column:1/3"><input id="agree" type="checkbox"> I agree to the Terms.</label>
    </div>
  </div>
  <div style="background:#12161d;border:1px solid #222a36;border-radius:14px;padding:18px">
    <div style="display:flex;justify-content:space-between"><b>Total</b><b id="total">R49.00</b></div>
    <button id="payBtn" disabled style="margin-top:12px;width:100%;padding:12px;border:none;border-radius:10px;background:#ef4444;color:#fff;font-weight:800">Pay by Card</button>
    <div style="margin-top:10px;color:#9aa6b2"><a href="/api/hello" style="color:#93c5fd" target="_blank">API ping</a></div>
  </div>
</div>
<script>
(function(){
  const prices={youtube:49,spotify:39,bundle:79}; const mult={monthly:1,quarterly:0.95*3,yearly:0.88*12};
  const totalEl=document.getElementById('total'), qty=document.getElementById('qty'),cycle=document.getElementById('cycle'),
        email=document.getElementById('email'),wa=document.getElementById('wa'),agree=document.getElementById('agree'),payBtn=document.getElementById('payBtn');
  function plan(){return document.querySelector('input[name=plan]:checked').value}
  function update(){
    const price=prices[plan()], q=Math.max(1,Math.min(6,parseInt(qty.value||'1'))), m=mult[cycle.value]; totalEl.textContent='R'+(price*q*m).toFixed(2);
    payBtn.disabled=!(agree.checked && email.value.includes('@') && (wa.value||'').length>=8);
  }
  document.querySelectorAll('input[name=plan]').forEach(r=>r.onchange=update);
  [qty,cycle,email,wa,agree].forEach(el=>el.oninput=update); update();
  payBtn.onclick=async()=>{
    const body={plan:plan(),quantity:Number(qty.value),billingCycle:cycle.value,email:email.value,whatsapp:wa.value};
    const r=await fetch('/api/payfast/create-checkout',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
    const d=await r.json(); if(d.mock) alert('Mock URL (add PayFast keys later):\n'+d.url); else location.href=d.url;
  };
})();
</script>
</body></html>